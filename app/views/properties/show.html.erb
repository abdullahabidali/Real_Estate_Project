<div class="container mx-auto px-4 py-8">
  <div class="bg-white rounded-lg shadow-lg overflow-hidden">
    <% if @property.images.attached? %>
      <div class="relative">
        <div class="swiper-container">
          <div class="swiper-wrapper">
            <% @property.images.each do |image| %>
              <div class="swiper-slide">
                <%= image_tag image, class: "w-full h-96 object-cover" %>
              </div>
            <% end %>
          </div>
          <div class="swiper-pagination"></div>
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
        </div>
      </div>
    <% end %>

    <div class="p-8">
      <div class="flex justify-between items-start mb-6">
        <div>
          <h1 class="text-3xl font-bold mb-2"><%= @property.title %></h1>
          <p class="text-gray-600 text-lg"><%= @property.address %>, <%= @property.city %>, <%= @property.state %> <%= @property.zip_code %></p>
        </div>
        <div class="text-right">
          <p class="text-2xl font-bold text-blue-600">$<%= number_with_delimiter(@property.price) %></p>
          <p class="text-sm text-gray-500"><%= @property.status.titleize %></p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-gray-50 p-4 rounded-lg">
          <p class="text-sm text-gray-500">Property Type</p>
          <p class="font-semibold"><%= @property.property_type.titleize %></p>
        </div>
        <div class="bg-gray-50 p-4 rounded-lg">
          <p class="text-sm text-gray-500">Bedrooms</p>
          <p class="font-semibold"><%= @property.bedrooms %></p>
        </div>
        <div class="bg-gray-50 p-4 rounded-lg">
          <p class="text-sm text-gray-500">Bathrooms</p>
          <p class="font-semibold"><%= @property.bathrooms %></p>
        </div>
        <div class="bg-gray-50 p-4 rounded-lg">
          <p class="text-sm text-gray-500">Area</p>
          <p class="font-semibold"><%= number_with_delimiter(@property.area) %> sq ft</p>
        </div>
      </div>

      <div class="mb-8">
        <h2 class="text-xl font-semibold mb-4">Description</h2>
        <p class="text-gray-700 leading-relaxed"><%= @property.description %></p>
      </div>

      <div class="flex justify-between items-center">
        <%= link_to "Back to Listings", properties_path, class: "text-blue-500 hover:text-blue-700" %>
        <% if user_signed_in? %>
          <% if current_user.favorite_properties.include?(@property) %>
            <%= button_to "Unfavorite", property_favorite_path(@property, current_user.favorites.find_by(property: @property)), method: :delete, class: "bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" %>
          <% else %>
            <%= button_to "Favorite", property_favorites_path(@property), method: :post, class: "bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" %>
          <% end %>
        <% end %>
        <% if user_signed_in? && current_user == @property.user %>
          <div class="space-x-4">
            <%= link_to "Edit", edit_property_path(@property), class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" %>
            <%= button_to "Delete", property_path(@property), method: :delete, class: "bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline", data: { confirm: "Are you sure?" } %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<% content_for :head do %>
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<% end %>

<% content_for :scripts do %>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      new Swiper('.swiper-container', {
        loop: true,
        pagination: {
          el: '.swiper-pagination',
          clickable: true
        },
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev',
        },
      });
    });
  </script>
<% end %>
